(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/pay/pay"],{"0d47":function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(n("a34a")),o=n("9c06");function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,a,o,s){try{var u=e[o](s),c=u.value}catch(d){return void n(d)}u.done?t(c):Promise.resolve(c).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function s(e){u(o,r,a,s,c,"next",e)}function c(e){u(o,r,a,s,c,"throw",e)}s(void 0)})}}var d={data:function(){return{addressInfo:null,checkedCart:[],userInfo:null,flag:!0}},computed:{totalPrice:function(){if(this.checkedCart)return this.checkedCart.reduce(function(e,t){return e+t.goods_price*t.goods_num},0)},address:function(){if(this.addressInfo)return this.addressInfo.provinceName+this.addressInfo.cityName+this.addressInfo.countyName+this.addressInfo.detailInfo}},onShow:function(){this.addressInfo=e.getStorageSync("address"),this.checkedCart=e.getStorageSync("checkedCart")},methods:{toPay:function(){var t=c(a.default.mark(function t(){var n,s,u,c,d,i,f,l,h;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,n=e.getStorageSync("token"),n){t.next=6;break}e.navigateTo({url:"../get-user-info/get-user-info"}),t.next=26;break;case 6:return s=this.totalPrice,u=this.address,c=[],this.checkedCart.forEach(function(e){return c.push({goods_id:e.goods_id,goods_number:e.goods_num,goods_price:e.goods_price})}),d={order_price:s,consignee_addr:u,goods:c},t.next=13,this.$request({url:"/my/orders/create",data:d,method:"POST"});case 13:return i=t.sent,f=i.data.message.order_number,t.next=17,this.$request({url:"/my/orders/req_unifiedorder",method:"POST",data:{order_number:f}});case 17:return l=t.sent,l.data.message.pay,t.next=21,(0,o.showToast)({title:"支付成功"});case 21:e.navigateTo({url:"../order/order"}),h=e.getStorageSync("cart"),h=h.filter(function(e){return!e.is_checked}),e.setStorageSync("cart",h),console.log(r(h," at pages\\pay\\pay.vue:132"));case 26:t.next=32;break;case 28:t.prev=28,t.t0=t["catch"](0),(0,o.showToast)({title:"支付失败"}),console.log(r(t.t0," at pages\\pay\\pay.vue:136"));case 32:case"end":return t.stop()}},t,this,[[0,28]])}));function n(){return t.apply(this,arguments)}return n}()}};t.default=d}).call(this,n("6e42")["default"],n("0de9")["default"])},"21da":function(e,t,n){},"373d":function(e,t,n){"use strict";n.r(t);var r=n("ffb3"),a=n("9ddc");for(var o in a)"default"!==o&&function(e){n.d(t,e,function(){return a[e]})}(o);n("6bfe");var s=n("2877"),u=Object(s["a"])(a["default"],r["a"],r["b"],!1,null,null,null);t["default"]=u.exports},"6bfe":function(e,t,n){"use strict";var r=n("21da"),a=n.n(r);a.a},"9ddc":function(e,t,n){"use strict";n.r(t);var r=n("0d47"),a=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,function(){return r[e]})}(o);t["default"]=a.a},abb9:function(e,t,n){"use strict";(function(e){n("1a38"),n("921b");r(n("66fd"));var t=r(n("373d"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},ffb3:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a})}},[["abb9","common/runtime","common/vendor"]]]);